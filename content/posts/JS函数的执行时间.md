---
title: "JS函数的执行时间"
date: 2019-10-16T11:08:19+08:00
draft: false
---

# JS 函数的执行时间

## 下边这段代码为什么会打印出 6 个 6？

```
let i = 0
for(i = 0; i<6; i++){
    setTimeout(()=>{
        console.log(i)
    },0)
}
```

因为设置了 Timeout,在执行 for 循环过程中，不会打印出 i 的值，当 i=6 时，跳出 for 循环，此时会打印出 i 的值，打印 6 次，此时 i = 6，因此会打印出 6 个 6。

## 写出让上边这段代码打印出 0,1,2,3,4,5 的方法

```
for(let i = 0; i<6; i++){
    setTimeout(()=>{
        console.log(i)
    },0)
}
```

即在 for 循环内部声明变量 `let i = 0`,此时就会打印出 0,1,2,3,4,5

## 其他打印出 0,1,2,3,4,5 的方法？

可以用立即执行函数：

```javaScript
let i;
for(i = 0; i<6; i++){
//这个匿名函数生成了闭包的效果，新建了一个作用域，这个作用域接收到每次循环的i值保存了下来，即使循环结束，闭包形成的作用域也不会被销毁
    (function(i){
        setTimeout(function () {
            console.log(i);
        });
    })(i)
}
```

这又是为什么？

这是因为 for 循环里定义的 i 变量其实暴露在全局作用域内，于是 5 个定时器里的匿名函数它们其实共享了同一个作用域里的同一个变量。

所以如果想要 0,1,2,3,4 的结果，就要在每次循环的时候，把当前的 i 值单独存下来，怎么存下当前的循环 i 值？？

利用闭包的原理，闭包使一个函数可以继续访问它定义时的作用域。而这个新生成的作用域将每一次循环的当前 i 值单独保存了下来。
